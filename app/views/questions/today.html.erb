<!-- 질문을 추가하기 위한 (어드민들만을 위한) 버튼입니다. 지우지 말아주세요. -->
<% if !current_user.nil? && current_user.id == 1 %>
    <%= link_to "Import All Questions", import_all_questions_path %><br>
    <%= link_to "Import New Questions", import_new_questions_path %><br><br>
<% end %>

<%= render "questions/layout", title: "오늘의 질문", questions: @questions %><br>

<script>
    $(".btn-write-modal").on('click', function() {
      
      form = $(this)
      $.ajax({
        type: "GET",
        url: form.attr('data-url'),
        success: function(data) {

          var html = $(`${data.html_content}`)

          $("#edit-background").find("#edit-box").append(html)
          $("#edit-background").show()
          $("body").css('overflow', 'hidden')
          textarea_init($(html.find('textarea')), $("#edit-background"))

          //편집 exit 버튼
          $("#btn-edit-exit").on('click', function() {
            html.remove()
            $("#edit-background").hide()
            $("body").css('overflow', 'auto')
          })
          
          //편집 완료
          $(".new_answer").submit( function(e) {
            e.preventDefault()

            form = $(this)
            console.log(form)
            $.ajax({
              type: "POST",
              url: form.attr('action'),
              data: form.serialize(),
              success: function(data) {
                console.log("successed")
                  html.remove()
                  $("#edit-background").hide()
                  $("body").css('overflow', 'auto')
              },
              error: function(data) {
                  console.log("error!")
              }
            })
          })
        },
        error: function(data) {
            console.log("error!")
        }
      })
      
    })

</script>